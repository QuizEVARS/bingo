<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bingo OptimisÃ©</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f8f8ff;
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
    }

    .main-container {
      max-width: 95vw;
      padding: 15px;
      box-sizing: border-box;
    }

    .bingo-grid {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 6px;
      width: 100%;
    }

    .bingo-case {
      aspect-ratio: 1 / 1; /* cases toujours carrÃ©es */
      border: 2px solid #9370db;
      background: linear-gradient(to bottom, #ffffff, #f0f8ff);
      border-radius: 8px;
      cursor: pointer;

      display: flex;
      justify-content: center;
      align-items: center;
      text-align: center;
      padding: 6px;

      font-family: 'Segoe UI', Tahoma, sans-serif;
      font-weight: 500;
      color: #333;

      overflow: hidden;
      word-wrap: break-word;
      transition: all 0.3s;
    }

    .bingo-case:hover {
      background: #e6e6fa;
      transform: scale(1.02);
      border-color: #4169e1;
    }

    .bingo-case.checked {
      background: linear-gradient(135deg, rgba(50, 205, 50, 0.7), rgba(34, 139, 34, 0.7));
      color: #333;
      border-color: #228b22;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }

    @media (max-width: 600px) {
      .bingo-grid {
        gap: 4px;
      }
    }
  </style>
</head>
<body>
  <div class="main-container">
    <div id="bingo" class="bingo-grid"></div>
    <button onclick="nouvellePartie()">Nouvelle Partie</button>
    <div id="msg-victoire" style="display:none; margin-top:10px; font-weight:bold; color:green;">ðŸŽ‰ Bingo gagnÃ© !</div>
  </div>

  <script>
    var phrases = [
      "Phrase un peu longue pour tester",
      "Mot court",
      "Encore une phrase qui doit s'adapter",
      "Texte court",
      "Un texte qui normalement prend beaucoup de place dans la case",
      "Milieu",
      "Exemple",
      "Autre contenu",
      "Ceci est un test",
      "DerniÃ¨re case de test",
      "Suite",
      "Encore",
      "Phrase alÃ©atoire",
      "Une autre",
      "Encore un texte",
      "Petit mot",
      "Case",
      "Demo",
      "Encore",
      "Test",
      "Longue phrase pour vÃ©rifier si Ã§a marche bien",
      "Mot",
      "Texte",
      "Case spÃ©ciale",
      "Dernier"
    ];

    var grilleData = [];
    var estGagne = false;

    function melanger(tableau) {
      for (let i = tableau.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [tableau[i], tableau[j]] = [tableau[j], tableau[i]];
      }
      return tableau;
    }

    function ajusterTaillePoliceCase(el) {
      let taille = 16; // taille de dÃ©part
      el.style.fontSize = taille + "px";
      while ((el.scrollHeight > el.clientHeight || el.scrollWidth > el.clientWidth) && taille > 7) {
        taille--;
        el.style.fontSize = taille + "px";
      }
    }

    function initGrille() {
      var container = document.getElementById('bingo');
      container.innerHTML = '';
      grilleData = melanger(phrases.slice(0, 25)).map(t => ({ texte: t, coche: false }));
      afficherLaGrille();
    }

    function afficherLaGrille() {
      var container = document.getElementById('bingo');
      container.innerHTML = '';
      for (var i = 0; i < 25; i++) {
        var div = document.createElement('div');
        div.className = 'bingo-case' + (grilleData[i].coche ? ' checked' : '');
        div.textContent = grilleData[i].texte;
        div.setAttribute('data-id', i);
        div.addEventListener('click', function () {
          var id = parseInt(this.getAttribute('data-id'));
          cocherCase(id);
        });
        container.appendChild(div);
        ajusterTaillePoliceCase(div); // ajuste la taille du texte pour cette case
      }
    }

    function cocherCase(id) {
      if (estGagne) return;
      grilleData[id].coche = !grilleData[id].coche;
      afficherLaGrille();
      setTimeout(checkVictoire, 100);
    }

    function checkVictoire() {
      var casesCochees = grilleData.map((c, i) => c.coche ? i : -1).filter(i => i >= 0);
      var gagnant = false;

      for (var i = 0; i < 5; i++) {
        if ([0, 1, 2, 3, 4].every(j => casesCochees.includes(i * 5 + j))) gagnant = true;
        if ([0, 1, 2, 3, 4].every(j => casesCochees.includes(j * 5 + i))) gagnant = true;
      }

      if ([0, 6, 12, 18, 24].every(pos => casesCochees.includes(pos))) gagnant = true;
      if ([4, 8, 12, 16, 20].every(pos => casesCochees.includes(pos))) gagnant = true;

      if (gagnant && !estGagne) {
        estGagne = true;
        document.getElementById('msg-victoire').style.display = 'block';
      }
    }

    function nouvellePartie() {
      estGagne = false;
      document.getElementById('msg-victoire').style.display = 'none';
      initGrille();
    }

    window.addEventListener('load', initGrille);
  </script>
</body>
</html>
